{% extends "comun/base.html" %}
{% load comun_filters %}

{% block content %}

<form method="get">

<table class="table table-striped">
  <thead>
    <tr>
      <th>Nombre</th>
      <th>Código</th>
      <th colspan="2">Organismo</th>
    </tr>  

    <tr>
      <th>
        {{ filterset.form|as_text_control:"nombre__icontains" }}
      </th>
      <th>
        {{ filterset.form|as_text_control:"codigo__icontains" }}
      </th>
      <th>
        {{ filterset.form|as_text_control:"organismo__nombre_organismo__icontains" }}
      </th>
      <th>
        <input type="submit" value="🔍" />
      </th>
    </tr> 
    
  </thead> 
</table>


  <div class="row">
  
{% for sistema in filterset.qs.all %}
<div class="col-4">
<div class="card">

  <a href="{{ sistema.url_detalle_sistema }}" alt="Ver detalles del S.I. {sistema}">
  {% if sistema.icono %}
    <img width="128" height="128"
         src="{{ sistema.icono.url }}" class="card-top-logo" alt="{{ sistema }}">
  {% else %}
    <img src="https://placehold.co/128x128" class="card-top-logo" alt="{{ sistema }}">
  {% endif %}  
  </a>  

  <div class="card-header">
      <h4 class="card-title">{{ sistema.codigo }}
          <br><small>{{ sistema.nombre }}</small>
      </h4>
      <h5>
          <a href="{% url 'sistemas:detalle_organismo' organismo=sistema.organismo %}">
      {{ sistema.organismo }}
      </a>    
      </h5>  
  </div>
  <div class="card-body">
    <p class="card-text">
      {{ sistema.descripcion|as_markdown }}
    </p>
    <span class="badge text-bg-primary">
        {{ sistema.tema }}
    </span>
    {% if sistema.es_transversal %}
      <span class="badge text-bg-info">Transversal</span>
    {% endif %}
    {% if sistema.es_subsistema_de %}
    <span class="badge text-bg-warning" title="de {{ sistema.es_subsistema_de }}">
        Subsistema
    </span>
    {% endif %}
  </div>
  <footer class="card-footer">
    <div class="btn-group" role="group" aria-label="Acciones">
    <a class="btn bg-info"
       href="{{ sistema.url_detalle_sistema }}"
       alt="Ver detalles del S.I. {sistema}">
        <i class="bi bi-pencil"></i>
    </a>
    </div>
    </footer>
</div>
</div>
{% endfor %}
  
  </div>


{% endblock content %}
